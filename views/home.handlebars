<h1>Aren't these little fluffy clouds pretty?</h1>

<div id="counter">
</div>

<script>
function updateCounter() {
	var request = new XMLHttpRequest();
	request.open('GET', "/counter", true);
	request.onload = function() {
		if (request.status >= 200 && request.status < 400) {
			// Success!
			var data = JSON.parse(request.responseText);
			var counterElement = document.getElementById('counter');
			counterElement.textContent = data.value + " rain drops";
		} else {
			// We reached our target server, but it returned an error
			counterElement.textContent = "Error. Refresh page!";
			clearTimeout(counterTimerId);
		}
	};
	request.onerror = function() {
		// There was a connection error of some sort
		counterElement.textContent = "Connection error. Refresh page!";
		clearTimeout(counterTimerId);
	};
	request.send();
};
updateCounter();
var counterTimerId = setInterval(updateCounter, 1000);
</script>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-78163214-1', 'auto');
ga('send', 'pageview');
</script>
